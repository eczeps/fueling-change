{% extends "main.html" %}

{% block navigation %}
    <div id="navigation">
        <ul>
        <li><a href="/">Home</a></li>
        <li><a href="/achievements/">Search Achievements</a></li>
        <li><a href="/users/">Search Users</a></li>
            {% if thisUser and request.method == "GET" %} <!-- hidden until login -->
                <li><a class="active" href="/profile/{{userURL}}/">My Profile</a></li>
                <li><a href="/login/">Log Out</a></li>
            {% elif thisUser %} <!-- hidden until login -->
                <li><a class="halfactive" href="/profile/{{userURL}}/">My Profile</a></li>
                <li><a href="/login/">Log Out</a></li>
            {% elif isLoggedIn != None %}
                <li><a class="quarteractive" href="/profile/{{userURL}}/">My Profile</a></li>
                <li><a href="/login/">Log Out</a></li>
            {% else %} <!-- hidden when logged in -->
                <li><a class="quarteractive" href="/profile/{{userURL}}/">My Profile</a></li>
                <li><a href="/login/">Login</a></li>
            {% endif %}
        </ul>
    </div>
{% endblock %}


{% block body %}
    {% if request.method == "GET" %}

    <div id="wrapper">
        <div id="left">
            <img src="{{url_for('static', filename = photohere)}}"
                 alt="Profile Photo for {{title}}"/>
        </div> <!-- end of left div -->
        
        <div id="right">
        <h1>Hi {{title}}</h1> 
        <p>Your current emissions are {{emissions}} kilograms of carbon dioxide per year</p>
        <p>What would you like to do today?</p>

        <form id="reporting" method=POST action="/useraction/{{userURL}}/">
            <button id="reportbtn" class="report-button" type="submit" name="submit" value="report">Report Achievements</button>
        </form>

        <form id="achieving" method=POST action="/profile/{{userURL}}/">
            <button id="reportbtn" class="report-button" type="submit" name="submit" value="stats">View My Statistics</button>
            <!-- statistics also includes achievements -->
        </form>
        </div> <!-- end of right div -->
    </div> <!-- end of wrapper div -->
    
    {% else %}
    <h1>Viewing {{title}}'s Achievements</h1>
        <!-- user statistics, percentiles, and footprint -->
        <p>Emissions: {{emissions}} kilograms of carbon dioxide per year</p>
        
        <!-- use a class="exlong" for whatever the largest element is -->
        <!-- completed achievements -->
        <div class="centerme">
        <h2><u>Completed Achievements</u></h2>
        <table class="exlong" id="completedAchieves">
            <tr>
                <th class="small">Earned</th>
                <th>Title</th>
                <th class="wide">Description</th>
            </tr>
            
            {% for achievement in compAchis %}
            {% set aID = achievement['AID'] %}
            {% if loop.index % 2 != 0 %}
                <tr class="colored" data-tt="{{aID}}">
            {% else %}
                <tr data-tt="{{aID}}">
            {% endif %}
                <td class="count">
                    {% if achievement['isRepeatable']==1 %}
                        <b>{{achievement['count']}}</b>
                    {% else %}
                        &#x2714;
                    {% endif %}
                </td>
                <td class="title"><b><a href="{{url_for('achieveinfo',AID=aID)}}">{{achievement['title']}}</a></b></td>
                <td class="description">{{achievement['description']}}</td>
            </tr>
            {% endfor %}
        </table>

        <!-- starred achievements -->
        <h2><u>Starred Achievements</u></h2>

        {% if starAchis|length != 0 %}
            <div class="visible">
        {% else %}
            <p>Star achievements from the <a href="{{url_for('achievement', searchFor='')}}">Search Achievements</a> tab.</p>
            <div class="tempinvisible">
        {% endif %}

        <table id="starredAchieves">
            <tr>
                <th>Title</th>
                <th class="wide">Description</th>
            </tr>
            
            {% for achievement in starAchis %}
            {% set aID = achievement['AID'] %}
            {% if loop.index % 2 != 0 %}
                <tr class="colored" data-tt="{{aID}}">
            {% else %}
                <tr data-tt="{{aID}}">
            {% endif %}
                <td class="title"><b><a href="{{url_for('achieveinfo',AID=aID)}}">{{achievement['title']}}</a></b></td>
                <td class="description">{{achievement['description']}}</td>
            </tr>
            {% endfor %}
        </table>
        </div> <!-- end of div with class tempinvisible or visible -->
        </div> <!-- end of centerme div -->
    {% endif %}
{% endblock %}